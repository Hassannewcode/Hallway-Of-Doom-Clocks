<!-- File: index.html -->
<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Hallway of Doom Clocks — immersive countdown journey through existential threats.">
  <title>Hallway of Doom Clocks</title>

  <!-- Performance & Fonts -->
  <link rel="preconnect" href="https://cdn.yourcdn.com">
  <link rel="preload" href="fonts/NeueMontreal-Regular.woff2" as="font" crossorigin>
  <link rel="preload" href="fonts/Digital-7.woff2" as="font" crossorigin>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Cookie Banner -->
  <div id="cookie-banner" role="dialog" aria-live="polite">
    <p>We use cookies to enhance your experience. <a href="legal/cookies.html">Learn more</a>.</p>
    <button id="accept-cookies">Accept</button>
  </div>

  <!-- Preloader -->
  <div id="preloader" aria-hidden="true"><div class="spinner"></div></div>
  <!-- Custom Cursor -->
  <div class="cursor" aria-hidden="true"></div>

  <!-- Three.js Canvas injected programmatically -->
  <main id="scroll-container">

    <!-- Intro with Video Loop -->
    <section class="intro" role="banner">
      <video class="bg-video" autoplay muted loop playsinline preload="auto">
        <source src="media/hallway_loop.mp4" type="video/mp4">
      </video>
      <div class="intro-content" data-cms-field="intro">
        <h1 class="title">Hallway of Doom Clocks</h1>
        <p class="subtitle">Scroll into the pulse of impending catastrophe.</p>
        <a href="#doomsday" class="btn-primary" id="cta-button">Explore the Risks</a>
      </div>
    </section>

    <!-- Clock Sections -->
    <section class="clock-section" id="doomsday" aria-labelledby="doomsday-heading" data-cms-field="doomsday">
      <h2 id="doomsday-heading">Doomsday Clock</h2>
      <p>The symbolic ticking of existential risk.</p>
      <div class="clock-wrap"><div class="clock-visual"><div class="display"></div></div></div>
    </section>

    <section class="clock-section" id="singularity" aria-labelledby="singularity-heading" data-cms-field="singularity">
      <h2 id="singularity-heading">AI Singularity Clock</h2>
      <p>Countdown to human-level AI—and beyond.</p>
      <div class="clock-wrap"><div class="clock-visual"><div class="display"></div></div></div>
    </section>

    <section class="clock-section" id="ecocide" aria-labelledby="ecocide-heading" data-cms-field="ecocide">
      <h2 id="ecocide-heading">Ecocide Clock</h2>
      <p>Measuring irreversible damage to our planet.</p>
      <div class="clock-wrap"><div class="clock-visual"><div class="display"></div></div></div>
    </section>

    <!-- Testimonials -->
    <section class="testimonials" aria-labelledby="testimonials-heading" data-cms-field="testimonials">
      <h2 id="testimonials-heading">What Experts Say</h2>
      <div class="slider">
        <blockquote><p>“A breathtaking portrayal of our times—both beautiful and terrifying.”</p><cite>— Dr. A. Researcher</cite></blockquote>
        <blockquote><p>“The visuals and narrative pulse sync perfectly with the urgency of AI risks.”</p><cite>— Prof. M. AI</cite></blockquote>
      </div>
    </section>

    <!-- Finale -->
    <section class="finale" role="contentinfo">
      <h2>The Final Tick</h2>
      <p>Beyond these halls... silence.</p>
    </section>

  </main>

  <!-- Footer -->
  <footer>
    <div class="footer-content">
      <p>&copy; 2025 Hallway of Doom. All rights reserved.</p>
      <nav aria-label="Legal">
        <a href="legal/privacy.html">Privacy Policy</a>
        <a href="legal/terms.html">Terms of Use</a>
        <a href="legal/cookies.html">Cookies</a>
      </nav>
    </div>
  </footer>

  <!-- Scripts -->
  <script type="module" src="app.js"></script>
</body>
</html>


<!-- File: styles.css -->
:root {
  --bg: #0a0a0a;
  --text: #f5f5f5;
  --accent: #fa1e0e;
  --led-dark: #111;
  --led-light: #50ff75;
  --transition-fast: 0.3s ease-out;
}
*{margin:0;padding:0;box-sizing:border-box;}html{scroll-behavior:smooth;}body{background:var(--bg);color:var(--text);font-family:'Neue Montreal',sans-serif;overflow-x:hidden;}
#preloader{position:fixed;top:0;left:0;width:100%;height:100%;background:var(--bg);display:flex;align-items:center;justify-content:center;z-index:1000;}#preloader .spinner{width:60px;height:60px;border:6px solid var(--led-dark);border-top-color:var(--accent);border-radius:50%;animation:spin 1s linear infinite;}@keyframes spin{to{transform:rotate(360deg);}}
.cursor{position:fixed;top:0;left:0;width:24px;height:24px;border:2px solid var(--accent);border-radius:50%;pointer-events:none;transform:translate(-50%,-50%);transition:transform 0.1s ease-out,background 0.2s ease-out;z-index:1100;} .cursor.hover{transform:translate(-50%,-50%) scale(1.8);background:rgba(250,30,14,0.2);}
.intro{position:relative;min-height:100vh;display:flex;align-items:center;justify-content:center;color:var(--text);overflow:hidden;} .bg-video{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:-1;} .intro-content{z-index:10;text-align:center;} .btn-primary{display:inline-block;margin-top:1.5rem;padding:0.75rem 1.5rem;background:var(--accent);color:#fff;text-decoration:none;border-radius:4px;transition:background var(--transition-fast);} .btn-primary:hover{background:#e2170b;}
section{padding:100px 20px;text-align:center;}
.clock-section{position:relative;background:linear-gradient(180deg,#080808,#0f0f0f);}
.clock-wrap{margin:2rem 0;display:flex;justify-content:center;}
.clock-visual{width:280px;height:120px;background:var(--led-dark);border-radius:8px;box-shadow:inset 0 0 20px #000;display:flex;justify-content:center;align-items:center;font-family:'Digital-7',monospace;font-size:3.5rem;color:var(--led-light);position:relative;} .clock-visual::before{content:"";position:absolute;width:250px;height:10px;background:rgba(255,255,255,0.05);top:10px;border-radius:5px;animation:pulse 2s ease-in-out infinite;} @keyframes pulse{0%,100%{opacity:0.05;}50%{opacity:0.2;}}
.clock-section:hover .clock-visual{transform:scale(1.05);box-shadow:0 0 30px var(--led-light);transition:transform var(--transition-fast),box-shadow var(--transition-fast);}
.testimonials{background:#111;color:var(--text);} .slider{display:grid;grid-auto-flow:column;overflow-x:auto;gap:2rem;padding:2rem 0;} blockquote{max-width:400px;} cite{display:block;margin-top:1rem;font-size:0.9rem;opacity:0.8;}
.finale{padding:120px 20px;background:#000;}
footer{background:#050505;padding:40px 20px;} footer .footer-content{max-width:960px;margin:auto;text-align:center;} footer nav a{color:var(--text);opacity:0.7;margin:0 0.8rem;font-size:0.9rem;transition:opacity var(--transition-fast);} footer nav a:hover{opacity:1;}
#cookie-banner{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#222;color:var(--text);padding:1rem 1.5rem;border-radius:6px;box-shadow:0 4px 12px rgba(0,0,0,0.5);display:flex;align-items:center;gap:1rem;z-index:1200;}#cookie-banner button{padding:0.5rem 1rem;background:var(--accent);border:none;color:#fff;border-radius:4px;cursor:pointer;}
@media(max-width:768px){.clock-visual{width:240px;height:100px;font-size:2.8rem;}h1.title{font-size:2.8rem;}h2{font-size:2.2rem;}}

/* File: app.js */
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";
import { Flip } from "gsap/Flip";
import { initHallway } from "./hallway.js";
import { initClocks } from "./clock.js";
gsap.registerPlugin(ScrollTrigger, Flip);

// Cookie banner
const banner = document.getElementById('cookie-banner');
const acceptBtn = document.getElementById('accept-cookies');
acceptBtn.addEventListener('click', () => banner.style.display = 'none');

// Preloader
window.addEventListener('load', () => {
  gsap.to("#preloader", { opacity: 0, duration: 0.6, onComplete: () => { document.getElementById('preloader').remove(); } });
});

// Cursor
const cursor = document.querySelector('.cursor');
window.addEventListener('mousemove', e => cursor.style.transform = `translate(${e.clientX}px,${e.clientY}px)`);
document.querySelectorAll('a, .clock-visual, .btn-primary').forEach(el => {
  el.addEventListener('mouseenter', () => cursor.classList.add('hover'));
  el.addEventListener('mouseleave', () => cursor.classList.remove('hover'));
});

// Initialize
initHallway();
initClocks();

// Scroll-triggered Flip animations
gsap.utils.toArray('.clock-wrap').forEach(wrapper => {
  const display = wrapper.querySelector('.display');
  let state = Flip.getState(display);
  ScrollTrigger.create({
    trigger: wrapper,
    start: 'top center',
    onEnter: () => {
      Flip.from(state, { duration: 0.6, ease: 'power2.inOut', absolute: true });
      state = Flip.getState(display);
    }
  });
});

/* File: clock.js */
export function initClocks(){
  document.querySelectorAll('.clock-visual').forEach((el, idx) => {
    const display = el.querySelector('.display');
    let total = 60 * (idx + 1);
    function step(){
      const mm = String(Math.floor(total / 60)).padStart(2, '0');
      const ss = String(total % 60).padStart(2, '0');
      display.textContent = mm + ':' + ss;
      total = (total - 1 + 3600) % 3600;
      requestAnimationFrame(step);
    }
    step();
  });
}

/* File: hallway.js */
import * as THREE from 'three';
import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
import { GlitchPass } from 'three/addons/postprocessing/GlitchPass.js';

export function initHallway(){
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 100);
  camera.position.z = 5;
  const renderer = new THREE.WebGLRenderer({ alpha: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setPixelRatio(window.devicePixelRatio);
  document.body.appendChild(renderer.domElement);

  const geom = new THREE.BoxGeometry(10, 10, 50);
  const mat = new THREE.MeshBasicMaterial({ color:0x010101, side:THREE.BackSide });
  scene.add(new THREE.Mesh(geom, mat));

  const composer = new EffectComposer(renderer);
  composer.addPass(new RenderPass(scene, camera));
  const glitch = new GlitchPass();
  composer.addPass(glitch);

  window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
    composer.setSize(window.innerWidth, window.innerHeight);
  });

  function animate(){
    requestAnimationFrame(animate);
    const prog = window.scrollY / (document.body.scrollHeight - window.innerHeight);
    camera.position.z = 5 + prog * 25;
    glitch.goWild = prog > 0.7;
    composer.render();
  }
  animate();
}
